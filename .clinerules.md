# cline用プロジェクト開発ルール

## 起動方法

- `npm run pm` コマンドでプログラムがバックグラウンドで起動します
- 標準出力終了時（対話終了時）にプログラムの稼働が開始されます

## 開発ワークフロー

1. ソースコードを変更した場合は、**必ずプログラムを再起動**してください
2. 変更後は実際にアクセスして動作確認を行ってください

## 重要な制約事項

## ブラウザ操作について

- Clineは独自のheadlessブラウザ機能を持っていますが、**このプロジェクトでは使用しないでください**
- 代わりに、このプロジェクト独自のカスタムheadlessブラウザ実装を使用してください
- プロジェクトのAPIを通じてブラウザ操作を行ってください
- **例外**: プロジェクト内にある画像ファイル（保存したスクリーンショット）を読み込む場合のみ、Cline固有のheadlessブラウザを使用しても構いません

## テスト環境

- テスト用ページ: [http://localhost:2000](http://localhost:2000)
- ソースコード変更時は上記URLにアクセスして動作確認を行ってください
- ブラウザ操作対象のアプリは [http://localhost:2501](http://localhost:2501) でテストします

## マウス座標について

- 画面解像度はデフォルトで1280×720に設定されています
  - 横方向の中央は x=640、縦方向の中央は y=360 となります
  - xの値を小さくすると左に、大きくすると右に移動します
  - yの値を小さくすると上に、大きくすると下に移動します
- 画面解像度は環境変数（.envファイル）で変更される可能性があることに留意してください
  - `VIEWPORT_WIDTH`と`VIEWPORT_HEIGHT`で設定されます
  - 解像度が変更された場合は、中央座標も変わります

---

## デバッグ方法

- pm2のログを確認する場合は、必ず以下のコマンドを使用してください：
  ```
  timeout 2 npx pm2 logs hono.js --lines 行数
  ```
  - 理由：timeoutを指定しないとターミナルがCtrl+Cするまで動かなくなります（clineはターミナルを途中終了できません）
- pm2はグローバルインストールされています

---

## Clineのファイル操作について

- 現在のファイル操作には`write_to_file`と`replace_in_file`APIを使用しています
- これらのAPIはGUIに負荷をかける可能性があります
- 将来的には、GUIに負担をかけない（開発者に表示しない）オプションが追加される予定です
- 現時点では、これらのAPIを通常通り使用してください
- 大量のファイル操作が必要な場合は、可能であれば`execute_command`でシェルコマンドを使用することを検討してください

---

## Gitコミットルール

- **重要**: ユーザーから明示的なコミット依頼があった場合のみ、Git操作を行ってください
  - 「コミットして」などの明確な指示がない限り、自動的にコミットしないでください
  - ファイルの変更後も、コミット指示がなければコミットせずに待機してください
- コミットする前に変更内容を確認するには以下のコマンドを使用してください：
  ```
  git diff > .git_changes.txt
  ```
  - このコマンドで変更内容をファイルに出力し、内容を確認できます
  - 注意: 直接 `git diff` を実行するとターミナルがフリーズする可能性があります
- コミットメッセージは以下の形式で記述してください：
  - `[update|add|delete] + 日本語メッセージ`
  - 例: `update: ブラウザ機能の改善`、`add: ログイン機能の実装`、`delete: 不要なコードの削除`

---

*このルールファイルは開発効率と品質を確保するために作成されています。*
